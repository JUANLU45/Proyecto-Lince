#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# PROYECTO LINCE - COMMIT-MSG HOOK
# VERIFICACI√ìN DEL FORMATO DE MENSAJES DE COMMIT

echo "üí¨ Verificando formato del mensaje de commit..."

# LEER EL MENSAJE DE COMMIT
commit_regex='^(feat|fix|docs|style|refactor|test|chore|perf|build|ci)(\(.+\))?: .{1,50}'

# VERIFICAR EL FORMATO
if ! grep -qE "$commit_regex" "$1"; then
  echo "‚ùå Formato de commit inv√°lido."
  echo ""
  echo "El mensaje debe seguir el formato:"
  echo "tipo(scope): descripci√≥n"
  echo ""
  echo "Tipos permitidos:"
  echo "  feat:     Nueva funcionalidad"
  echo "  fix:      Correcci√≥n de bug"
  echo "  docs:     Cambios en documentaci√≥n"
  echo "  style:    Cambios de formato (no afectan funcionalidad)"
  echo "  refactor: Refactoring de c√≥digo"
  echo "  test:     Agregar o modificar tests"
  echo "  chore:    Tareas de mantenimiento"
  echo "  perf:     Mejoras de performance"
  echo "  build:    Cambios en build system"
  echo "  ci:       Cambios en CI/CD"
  echo ""
  echo "Ejemplos v√°lidos:"
  echo "  feat(auth): agregar login con Firebase"
  echo "  fix(ui): corregir layout en pantalla principal"
  echo "  docs: actualizar README con instrucciones"
  echo "  test(utils): agregar tests para validation"
  echo ""
  exit 1
fi

echo "‚úÖ Formato de mensaje de commit v√°lido."